## ğŸ›ï¸ å•†å“ API

## æƒé™æ›´æ–°ï¼ˆBACKEND-010ï¼‰

`/products` å†™æ¥å£å·²ç»Ÿä¸€ä½¿ç”¨ `requireRole('admin', 'operator')`ã€‚  
å³ï¼š`admin` ä¸ `operator` å‡å¯ç®¡ç†å•†å“ï¼Œ`user` æ— æƒé™ã€‚

| æ–¹æ³• | è·¯å¾„ | æƒé™è¦æ±‚ |
|------|------|----------|
| POST | `/products` | ç™»å½• + `admin/operator` |
| GET | `/products/admin/all` | ç™»å½• + `admin/operator` |
| PUT | `/products/batch/stock` | ç™»å½• + `admin/operator` |
| DELETE | `/products/batch` | ç™»å½• + `admin/operator` |
| POST | `/products/batch/restore` | ç™»å½• + `admin/operator` |
| GET | `/products/deleted` | ç™»å½• + `admin/operator` |
| PUT | `/products/:id` | ç™»å½• + `admin/operator` |
| DELETE | `/products/:id` | ç™»å½• + `admin/operator` |
| PUT | `/products/:id/stock` | ç™»å½• + `admin/operator` |
| POST | `/products/:id/restore` | ç™»å½• + `admin/operator` |

### è·å–å•†å“åˆ—è¡¨

**GET** `/products`

**æŸ¥è¯¢å‚æ•°**:
- `pageNum` (å¯é€‰): é¡µç ï¼Œé»˜è®¤1
- `pageSize` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤10
- `keyword` (å¯é€‰): æœç´¢å…³é”®è¯
- `categoryId` (å¯é€‰): åˆ†ç±»ID
- `minPrice` (å¯é€‰): æœ€ä½ä»·æ ¼
- `maxPrice` (å¯é€‰): æœ€é«˜ä»·æ ¼
- `status` (å¯é€‰): å•†å“çŠ¶æ€(1:ä¸Šæ¶, 0:ä¸‹æ¶)
- `sortBy` (å¯é€‰): æ’åºå­—æ®µï¼Œé»˜è®¤`createdAt`ï¼Œæ”¯æŒ`createdAt`, `price`, `name`, `stock`
- `sortOrder` (å¯é€‰): æ’åºæ–¹å‘ï¼Œé»˜è®¤`desc`ï¼Œæ”¯æŒ`asc`, `desc`
- `includeDisabledCategories` (å¯é€‰): æ˜¯å¦åŒ…å«ç¦ç”¨åˆ†ç±»ä¸‹çš„å•†å“ (false:ä»…å¯ç”¨åˆ†ç±», true:åŒ…å«ç¦ç”¨åˆ†ç±»)ï¼Œé»˜è®¤falseï¼Œä»…ç®¡ç†å‘˜å¯ä½¿ç”¨true

**æƒé™è¯´æ˜**:
- é»˜è®¤è¡Œä¸º (falseæˆ–æœªè®¾ç½®): ä»…è¿”å›å¯ç”¨åˆ†ç±»ä¸‹çš„å•†å“ï¼Œé€‚ç”¨äºNuxtå•†åŸå‰å°
- ç®¡ç†å‘˜æƒé™(true): éœ€è¦ç®¡ç†å‘˜è§’è‰²ï¼Œè¿”å›æ‰€æœ‰åˆ†ç±»ä¸‹çš„å•†å“ï¼Œé€‚ç”¨äºSoybin Adminåå°ç®¡ç†

**æ’åºåŠŸèƒ½ (v1.1.0 æ–°å¢)**:
- ğŸ’° **ä»·æ ¼æ’åº**: `sortBy=price&sortOrder=asc` æŒ‰ä»·æ ¼ä»ä½åˆ°é«˜
- ğŸ“ **åç§°æ’åº**: `sortBy=name&sortOrder=asc` æŒ‰åç§°A-Z
- ğŸ“¦ **åº“å­˜æ’åº**: `sortBy=stock&sortOrder=desc` æŒ‰åº“å­˜ä»é«˜åˆ°ä½
- ğŸ•’ **åˆ›å»ºæ—¶é—´æ’åº**: `sortBy=createdAt&sortOrder=desc` (é»˜è®¤ï¼ŒæŒ‰åˆ›å»ºæ—¶é—´é™åº)

**æ’åºç¤ºä¾‹**:
```
GET /products?sortBy=price&sortOrder=asc
GET /products?sortBy=name&sortOrder=desc
GET /products?sortBy=stock&sortOrder=desc
GET /products?categoryId=cat123&sortBy=price&sortOrder=asc
```

**ç¤ºä¾‹è¯·æ±‚**:
```
GET /products?pageNum=1&pageSize=10&categoryId=clt123456789&minPrice=100&maxPrice=1000&keyword=ä¼ æ„Ÿå™¨
GET /products?pageNum=1&pageSize=10&includeDisabledCategories=true  // ç®¡ç†å‘˜ä¸“ç”¨
```

**å“åº”**:
```json
{
  "code": 200,
  "message": "Products retrieved successfully",
  "data": {
    "list": [
      {
        "id": "clt123456789",
        "name": "æ™ºèƒ½æ¸©åº¦ä¼ æ„Ÿå™¨",
        "description": "é«˜ç²¾åº¦æ¸©åº¦ç›‘æµ‹ä¼ æ„Ÿå™¨",
        "content": "<h1>æ™ºèƒ½æ¸©åº¦ä¼ æ„Ÿå™¨äº§å“è¯¦æƒ…</h1><p>é‡‡ç”¨é«˜ç²¾åº¦æ•°å­—ä¼ æ„Ÿå™¨ï¼Œé€‚ç”¨äºå„ç§ç¯å¢ƒç›‘æµ‹åœºæ™¯ã€‚</p><ul><li>ç²¾åº¦ï¼šÂ±0.5â„ƒ</li><li>å·¥ä½œæ¸©åº¦ï¼š-40~85â„ƒ</li><li>ä¾›ç”µï¼šDC 5V</li><li>é€šä¿¡ï¼šI2C/SPI</li></ul>",
        "price": 299.99,
        "originalPrice": 399.99,
        "stock": 100,
        "images": ["https://example.com/image1.jpg", "https://example.com/image2.jpg"],
        "specifications": "{\"ç²¾åº¦\":\"Â±0.5â„ƒ\",\"å·¥ä½œæ¸©åº¦\":\"-40~85â„ƒ\",\"ä¾›ç”µ\":\"DC 5V\"}",
        "status": 1,
        "category": {
          "id": "clt123456788",
          "name": "æ™ºèƒ½ä¼ æ„Ÿå™¨",
          "status": 1
        },
        "hasPrice": true,         // ğŸ†• æ–°å¢ï¼šåˆ¤æ–­å•†å“æ˜¯å¦æœ‰ä»·æ ¼ï¼Œfalse=å’¨è¯¢å•†å“, true=è´­ä¹°å•†å“
        "tags": ["çƒ­é”€", "æ–°å“", "æ¨è"], // ğŸ·ï¸ æ–°å¢ï¼šå•†å“æ ‡ç­¾æ•°ç»„ï¼Œæ— æ ‡ç­¾æ—¶ä¸ºnull
        "createdAt": "2025-12-03T10:00:00.000Z"
      }
    ],
    "total": 50,
    "pageNum": 1,
    "pageSize": 10,
    "totalPages": 5
  },
  "success": true
}
```

### ğŸ”¥ ä»·æ ¼åŒºåˆ†å­—æ®µè¯´æ˜ (v1.4.0 æ–°å¢)

#### hasPriceå­—æ®µ
**åŠŸèƒ½è¯´æ˜**: æ‰€æœ‰å•†å“ç›¸å…³APIè¿”å›çš„æ•°æ®ä¸­ç°åœ¨åŒ…å«`hasPrice`å­—æ®µï¼Œç”¨äºåŒºåˆ†è´­ä¹°å‹å•†å“å’Œå’¨è¯¢å‹å•†å“ã€‚

**å­—æ®µå®šä¹‰**:
- `hasPrice: boolean` - `true`è¡¨ç¤ºæœ‰ä»·æ ¼å•†å“ï¼ˆå¯è´­ä¹°ï¼‰ï¼Œ`false`è¡¨ç¤ºæ— ä»·æ ¼å•†å“ï¼ˆéœ€å’¨è¯¢ï¼‰

**å‰ç«¯ä½¿ç”¨é€»è¾‘**:
```javascript
// å•†å“è¯¦æƒ…é¡µæŒ‰é’®æ˜¾ç¤ºé€»è¾‘
if (product.hasPrice) {
  // æœ‰ä»·æ ¼å•†å“
  <button onClick={addToCart}>ç«‹å³è´­ä¹°</button>
  <span>ä»·æ ¼: Â¥{product.price}</span>
} else {
  // æ— ä»·æ ¼å•†å“
  <button onClick={showConsultationForm}>ç«‹å³å’¨è¯¢</button>
  <span>ä»·æ ¼: éœ€æŠ¥ä»·</span>
}
```

**å“åº”ç¤ºä¾‹å¯¹æ¯”**:

```json
// æœ‰ä»·æ ¼å•†å“
{
  "id": "product-001",
  "name": "æ™ºèƒ½æ¸©åº¦ä¼ æ„Ÿå™¨",
  "price": 299.99,
  "hasPrice": true,
  "status": 1
}

// æ— ä»·æ ¼å•†å“ï¼ˆå’¨è¯¢å•†å“ï¼‰
{
  "id": "product-002",
  "name": "å®šåˆ¶åŒ–å·¥ä¸šè®¾è®¡",
  "price": null,
  "hasPrice": false,
  "status": 1
}
```

**é€‚ç”¨èŒƒå›´**: ä»¥ä¸‹æ‰€æœ‰å•†å“APIéƒ½è¿”å›`hasPrice`å­—æ®µï¼š
- `GET /products` - è·å–å•†å“åˆ—è¡¨
- `GET /products/:id` - è·å–å•†å“è¯¦æƒ…
- `GET /products/search` - æœç´¢å•†å“
- `GET /products/popular` - è·å–çƒ­é—¨å•†å“
- `GET /products/category/:categoryId` - æ ¹æ®åˆ†ç±»è·å–å•†å“
- `GET /products/admin/all` - ç®¡ç†ç«¯ï¼ˆadmin/operatorï¼‰è·å–æ‰€æœ‰å•†å“

**ä¸šåŠ¡åœºæ™¯**:
- ğŸ’³ **æœ‰ä»·æ ¼å•†å“**: æ ‡å‡†ç”µå•†å•†å“ï¼Œç›´æ¥åœ¨çº¿è´­ä¹°
- ğŸ“ **æ— ä»·æ ¼å•†å“**: å®šåˆ¶åŒ–äº§å“ã€éœ€è¦æŠ¥ä»·çš„å•†å“ã€ä¼ä¸šé‡‡è´­å’¨è¯¢
- ğŸ”„ **ä»·æ ¼åŒºåˆ†**: å‰ç«¯æ ¹æ®hasPriceæ˜¾ç¤ºä¸åŒæŒ‰é’®å’Œä»·æ ¼ä¿¡æ¯
- âœ¨ **ç»Ÿä¸€ä½“éªŒ**: ä¿æŒä¸€è‡´çš„APIå“åº”æ ¼å¼

**å‰ç«¯é›†æˆå»ºè®®**:
1. ä½¿ç”¨`product.hasPrice`åˆ¤æ–­æŒ‰é’®ç±»å‹
2. æœ‰ä»·æ ¼å•†å“èµ°æ ‡å‡†è´­ç‰©è½¦æµç¨‹
3. æ— ä»·æ ¼å•†å“è·³è½¬åˆ°å’¨è¯¢è¡¨å•
4. å’¨è¯¢è¡¨å•ä½¿ç”¨ç¦»çº¿è®¢å•APIæäº¤

### ğŸ·ï¸ å•†å“æ ‡ç­¾å­—æ®µè¯´æ˜ (v1.4.1 æ–°å¢)

#### tagså­—æ®µ
**åŠŸèƒ½è¯´æ˜**: æ‰€æœ‰å•†å“ç›¸å…³APIè¿”å›çš„æ•°æ®ä¸­ç°åœ¨åŒ…å«`tags`å­—æ®µï¼Œä¸ºå•†å“æä¾›çµæ´»çš„æ ‡ç­¾ç³»ç»Ÿã€‚

**å­—æ®µå®šä¹‰**:
- `tags: string[] | null` - å•†å“æ ‡ç­¾æ•°ç»„ï¼Œæ— æ ‡ç­¾æ—¶ä¸º`null`

**å‰ç«¯ä½¿ç”¨é€»è¾‘**:
```javascript
// å•†å“æ ‡ç­¾æ˜¾ç¤ºé€»è¾‘
const productTags = product.tags || [];
if (productTags.length > 0) {
  // æœ‰æ ‡ç­¾ï¼Œæ˜¾ç¤ºæ ‡ç­¾åˆ—è¡¨
  productTags.forEach(tag => {
    console.log('æ ‡ç­¾:', tag);
  });
} else {
  // æ— æ ‡ç­¾ï¼Œéšè—æˆ–æ˜¾ç¤ºç©ºçŠ¶æ€
  console.log('æš‚æ— æ ‡ç­¾');
}

// åˆ›å»º/æ›´æ–°å•†å“æ—¶çš„æ ‡ç­¾æ•°æ®
const createProductData = {
  name: "å•†å“åç§°",
  price: 199.99,
  categoryId: "category_id",
  tags: ["çƒ­é”€", "æ–°å“", "æ¨è"] // æ ‡ç­¾æ•°ç»„ï¼Œæ”¯æŒä»»æ„å­—ç¬¦ä¸²
};
```

**æ”¯æŒæ ¼å¼**:
- **æ•°ç»„æ ¼å¼**: `["æ ‡ç­¾1", "æ ‡ç­¾2", "æ ‡ç­¾3"]`
- **é€—å·åˆ†éš”**: `"æ ‡ç­¾1,æ ‡ç­¾2,æ ‡ç­¾3"` (è‡ªåŠ¨è½¬æ¢)
- **ç©ºå€¼**: `null` æˆ–ç©ºæ•°ç»„
- **è‡ªåŠ¨å¤„ç†**: è¿‡æ»¤ç©ºå­—ç¬¦ä¸²å’Œæ— æ•ˆå†…å®¹

**é€‚ç”¨èŒƒå›´**: ä»¥ä¸‹æ‰€æœ‰å•†å“APIéƒ½è¿”å›`tags`å­—æ®µï¼š
- `GET /products` - è·å–å•†å“åˆ—è¡¨
- `GET /products/admin/all` - ç®¡ç†ç«¯ï¼ˆadmin/operatorï¼‰è·å–æ‰€æœ‰å•†å“
- `GET /products/:id` - è·å–å•†å“è¯¦æƒ…
- `GET /products/search` - æœç´¢å•†å“
- `GET /products/popular` - è·å–çƒ­é—¨å•†å“
- `GET /products/category/:categoryId` - æ ¹æ®åˆ†ç±»è·å–å•†å“
- `POST /products` - åˆ›å»ºå•†å“ï¼ˆæ”¯æŒtagså­—æ®µï¼‰
- `PUT /products/:id` - æ›´æ–°å•†å“ï¼ˆæ”¯æŒtagså­—æ®µï¼‰

---

### ç®¡ç†ç«¯ï¼šè·å–æ‰€æœ‰å•†å“

**GET** `/products/admin/all`

**è®¤è¯**: å¿…éœ€è®¤è¯ + `admin`/`operator` è§’è‰²

**æƒé™è¯´æ˜**:
- ä¸“é—¨ä¸ºSoybean Adminç®¡ç†åå°è®¾è®¡
- è¿”å›æ‰€æœ‰å•†å“ï¼ˆåŒ…æ‹¬ç¦ç”¨åˆ†ç±»ä¸‹çš„å•†å“ï¼‰
- ä¸å—åˆ†ç±»çŠ¶æ€å½±å“ï¼Œå®Œæ•´æ˜¾ç¤ºå•†å“åˆ—è¡¨

**æŸ¥è¯¢å‚æ•°**:
- `pageNum` (å¯é€‰): é¡µç ï¼Œé»˜è®¤1
- `pageSize` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤10
- `keyword` (å¯é€‰): æœç´¢å…³é”®è¯
- `categoryId` (å¯é€‰): åˆ†ç±»ID
- `minPrice` (å¯é€‰): æœ€ä½ä»·æ ¼
- `maxPrice` (å¯é€‰): æœ€é«˜ä»·æ ¼
- `status` (å¯é€‰): å•†å“çŠ¶æ€(1:ä¸Šæ¶, 0:ä¸‹æ¶)

**ç¤ºä¾‹è¯·æ±‚**:
```
GET /products/admin/all?pageNum=1&pageSize=10&keyword=ä¼ æ„Ÿå™¨
Authorization: Bearer <admin_or_operator_token>
```

**æƒé™æ£€æŸ¥**:
- 401 Unauthorized: æœªæä¾›token
- 403 Forbidden: é `admin`/`operator` è§’è‰²

### æœç´¢å•†å“

**GET** `/products/search`

**æŸ¥è¯¢å‚æ•°**:
- `keyword` (å¿…éœ€): æœç´¢å…³é”®è¯
- `pageNum` (å¯é€‰): é¡µç ï¼Œé»˜è®¤1
- `pageSize` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤10
- `categoryId` (å¯é€‰): åˆ†ç±»ID
- `minPrice` (å¯é€‰): æœ€ä½ä»·æ ¼
- `maxPrice` (å¯é€‰): æœ€é«˜ä»·æ ¼

**ç¤ºä¾‹è¯·æ±‚**:
```
GET /products/search?keyword=æ¸©åº¦ä¼ æ„Ÿå™¨&categoryId=clt123456788
```

### è·å–å•†å“è¯¦æƒ…

**GET** `/products/:id`

**å“åº”**:
```json
{
  "code": 200,
  "message": "Product retrieved successfully",
  "data": {
    "id": "clt123456789",
    "name": "æ™ºèƒ½æ¸©åº¦ä¼ æ„Ÿå™¨",
    "description": "é«˜ç²¾åº¦æ¸©åº¦ç›‘æµ‹ä¼ æ„Ÿå™¨ï¼Œé€‚ç”¨äºå„ç§ç¯å¢ƒç›‘æµ‹åœºæ™¯",
    "content": "<h1>æ™ºèƒ½æ¸©åº¦ä¼ æ„Ÿå™¨äº§å“è¯¦æƒ…</h1><p>é‡‡ç”¨é«˜ç²¾åº¦æ•°å­—ä¼ æ„Ÿå™¨ï¼Œé€‚ç”¨äºå„ç§ç¯å¢ƒç›‘æµ‹åœºæ™¯ã€‚</p><ul><li>ç²¾åº¦ï¼šÂ±0.5â„ƒ</li><li>å·¥ä½œæ¸©åº¦ï¼š-40~85â„ƒ</li><li>ä¾›ç”µï¼šDC 5V</li><li>é€šä¿¡ï¼šI2C/SPI</li></ul>",
    "price": 299.99,
    "originalPrice": 399.99,
    "stock": 100,
    "images": ["https://example.com/image1.jpg", "https://example.com/image2.jpg"],
    "specifications": "{\"ç²¾åº¦\":\"Â±0.5â„ƒ\",\"å·¥ä½œæ¸©åº¦\":\"-40~85â„ƒ\",\"ä¾›ç”µ\":\"DC 5V\"}",
    "status": 1,
    "category": {
      "id": "clt123456788",
      "name": "æ™ºèƒ½ä¼ æ„Ÿå™¨"
    },
    "hasPrice": true,
    "tags": ["çƒ­é”€", "æ–°å“"],
    "createdAt": "2025-12-02T10:00:00.000Z",
    "updatedAt": "2025-12-02T10:00:00.000Z",
    "relatedProducts": [
      {
        "id": "clt123456790",
        "name": "æ™ºèƒ½æ¹¿åº¦ä¼ æ„Ÿå™¨",
        "price": 259.99,
        "hasPrice": true,
        "images": ["https://example.com/image3.jpg"]
      }
    ]
  },
  "success": true
}
```

### è·å–çƒ­é—¨å•†å“

**GET** `/products/popular`

**æŸ¥è¯¢å‚æ•°**:
- `pageSize` (å¯é€‰): æ•°é‡ï¼Œé»˜è®¤10

**å“åº”**:
```json
{
  "code": 200,
  "message": "Popular products retrieved successfully",
  "data": [
    {
      "id": "clt123456789",
      "name": "æ™ºèƒ½æ¸©åº¦ä¼ æ„Ÿå™¨",
      "price": 299.99,
      "hasPrice": true,
      "images": ["https://example.com/image1.jpg"],
      "category": {
        "id": "clt123456788",
        "name": "æ™ºèƒ½ä¼ æ„Ÿå™¨",
        "status": 1
      }
    }
  ],
  "success": true
}
```

### æ ¹æ®åˆ†ç±»è·å–å•†å“

**GET** `/products/category/:categoryId`

**è®¤è¯**: Optional

**æŸ¥è¯¢å‚æ•°**:
- `pageNum` (å¯é€‰): é¡µç ï¼Œé»˜è®¤1
- `pageSize` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤10

### è·å–ç›¸å…³å•†å“

**GET** `/products/:id/related`

**è®¤è¯**: Optional

**æŸ¥è¯¢å‚æ•°**:
- `limit` (å¯é€‰): æ•°é‡ï¼Œé»˜è®¤5

### åˆ›å»ºå•†å“

**POST** `/products`

**è®¤è¯**: Required + Admin/Operator

**è¯·æ±‚ä½“**:
```json
{
  "name": "æ™ºèƒ½æ¸©åº¦ä¼ æ„Ÿå™¨",
  "description": "é«˜ç²¾åº¦æ¸©åº¦ç›‘æµ‹ä¼ æ„Ÿå™¨",
  "content": "<h1>äº§å“è¯¦æƒ…</h1><p>è¿™é‡Œæ˜¯å¯Œæ–‡æœ¬å†…å®¹</p>",
  "price": 299.99,
  "originalPrice": 399.99,
  "stock": 100,
  "categoryId": "clt123456788",
  "images": ["https://example.com/image1.jpg", "https://example.com/image2.jpg"],
  "specifications": "{\"ç²¾åº¦\":\"Â±0.5â„ƒ\",\"å·¥ä½œæ¸©åº¦\":\"-40~85â„ƒ\"}",
  "tags": ["çƒ­é”€", "æ–°å“", "æ¨è"],
  "status": 1
}
```

**è¯´æ˜**:
- `price` ä¸º `null` æˆ– `0` æ—¶åˆ›å»ºå’¨è¯¢å•†å“ï¼ˆ`hasPrice=false`ï¼‰
- `price` å¤§äº `0` æ—¶åˆ›å»ºè´­ä¹°å•†å“ï¼ˆ`hasPrice=true`ï¼‰

### æ›´æ–°å•†å“

**PUT** `/products/:id`

**è®¤è¯**: Required + Admin/Operator

**è¯·æ±‚ä½“**:
```json
{
  "name": "æ›´æ–°åçš„å•†å“åç§°",
  "description": "æ›´æ–°åçš„æè¿°",
  "content": "<h1>æ›´æ–°åçš„äº§å“è¯¦æƒ…</h1><p>æ–°çš„å¯Œæ–‡æœ¬å†…å®¹</p>",
  "price": 349.99,
  "stock": 150,
  "status": 1,
  "tags": ["çƒ­é”€"]
}
```

**è¯´æ˜**:
- `price` è®¾ç½®ä¸º `null` æˆ–ç©ºå­—ç¬¦ä¸²å¯å°†å•†å“è½¬ä¸ºå’¨è¯¢å•†å“
- `price` è®¾ç½®ä¸ºå¤§äº `0` çš„æ•°å€¼å¯å°†å•†å“è½¬ä¸ºè´­ä¹°å•†å“

### åˆ é™¤å•†å“

**DELETE** `/products/:id`

**è®¤è¯**: Required + Admin/Operator

**è¯´æ˜**: ä½¿ç”¨é€»è¾‘åˆ é™¤ï¼Œå•†å“ä¸ä¼šä»æ•°æ®åº“ä¸­ç‰©ç†åˆ é™¤

### æ‰¹é‡åˆ é™¤å•†å“ ğŸ†•

**DELETE** `/products/batch`

**è®¤è¯**: Required + Admin/Operator

**è¯·æ±‚ä½“**:
```json
{
  "productIds": ["clt123456789", "clt123456790", "clt123456791"]
}
```

**é™åˆ¶**: ä¸€æ¬¡æœ€å¤šåˆ é™¤20ä¸ªå•†å“

**å“åº”**:
```json
{
  "code": 200,
  "message": "æ‰¹é‡åˆ é™¤å®Œæˆï¼šæˆåŠŸåˆ é™¤2ä¸ªå•†å“ï¼Œå¤±è´¥1ä¸ª",
  "data": {
    "deleted": 2,
    "failed": ["clt123456791"],
    "total": 3
  },
  "success": true
}
```

**è¯´æ˜**:
- ä½¿ç”¨é€»è¾‘åˆ é™¤ï¼Œè®¾ç½® `isDeleted=true`
- å·²å…³è”è®¢å•çš„å•†å“æ— æ³•åˆ é™¤ï¼Œä¼šè¿”å›åœ¨ `failed` æ•°ç»„ä¸­

### æ›´æ–°åº“å­˜

**PUT** `/products/:id/stock`

**è®¤è¯**: Required + Admin/Operator

**è¯·æ±‚ä½“**:
```json
{
  "quantity": 50
}
```

**è¯´æ˜**: quantity ä¸ºæ­£æ•°è¡¨ç¤ºå¢åŠ åº“å­˜ï¼Œä¸ºè´Ÿæ•°è¡¨ç¤ºå‡å°‘åº“å­˜

### æ‰¹é‡æ›´æ–°åº“å­˜ âœ… å·²ä¿®æ­£

**PUT** `/products/batch/stock`

**è®¤è¯**: Required + Admin/Operator

**è¯·æ±‚ä½“**:
```json
{
  "items": [
    {
      "productId": "clt123456789",
      "quantity": 20
    },
    {
      "productId": "clt123456790",
      "quantity": -10
    }
  ]
}
```

**è¯´æ˜**:
- `quantity` ä¸ºæ­£æ•°è¡¨ç¤ºå¢åŠ åº“å­˜ï¼Œä¸ºè´Ÿæ•°è¡¨ç¤ºå‡å°‘åº“å­˜
- ä½¿ç”¨åŸå­æ“ä½œç¡®ä¿åº“å­˜æ›´æ–°çš„ä¸€è‡´æ€§
- å¦‚æœåº“å­˜ä¸è¶³ä¼šè‡ªåŠ¨å›æ»šæ“ä½œ

### ğŸ—‘ï¸ æ¢å¤å·²åˆ é™¤å•†å“ ğŸ†•

**POST** `/products/:id/restore`

**è®¤è¯**: Required + Admin/Operator

**æƒé™è¯´æ˜**: `admin` ä¸ `operator` å‡å¯æ¢å¤å·²åˆ é™¤å•†å“

**å“åº”**:
```json
{
  "code": 200,
  "message": "å•†å“æ¢å¤æˆåŠŸ",
  "data": {
    "id": "clt123456789",
    "name": "æ™ºèƒ½æ¸©åº¦ä¼ æ„Ÿå™¨",
    "isDeleted": false,
    "status": 1,
    "updatedAt": "2026-02-04T10:00:00.000Z"
  },
  "success": true
}
```

### ğŸ—‘ï¸ æ‰¹é‡æ¢å¤å•†å“ ğŸ†•

**POST** `/products/batch/restore`

**è®¤è¯**: Required + Admin/Operator

**æƒé™è¯´æ˜**: `admin` ä¸ `operator` å‡å¯æ‰¹é‡æ¢å¤å·²åˆ é™¤å•†å“

**è¯·æ±‚ä½“**:
```json
{
  "productIds": ["clt123456789", "clt123456790", "clt123456791"]
}
```

**é™åˆ¶**: ä¸€æ¬¡æœ€å¤šæ¢å¤20ä¸ªå•†å“

**å“åº”**:
```json
{
  "code": 200,
  "message": "æ‰¹é‡æ¢å¤å®Œæˆï¼šæˆåŠŸæ¢å¤2ä¸ªå•†å“ï¼Œå¤±è´¥0ä¸ª",
  "data": {
    "restored": 2,
    "failed": [],
    "total": 2
  },
  "success": true
}
```

### ğŸ—‘ï¸ è·å–å·²åˆ é™¤å•†å“åˆ—è¡¨ ğŸ†•

**GET** `/products/deleted`

**è®¤è¯**: Required + Admin/Operator

**æƒé™è¯´æ˜**: `admin` ä¸ `operator` å‡å¯æŸ¥çœ‹å·²åˆ é™¤å•†å“

**æŸ¥è¯¢å‚æ•°**:
- `pageNum` (å¯é€‰): é¡µç ï¼Œé»˜è®¤1
- `pageSize` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤10
- `keyword` (å¯é€‰): æœç´¢å…³é”®è¯
- `categoryId` (å¯é€‰): åˆ†ç±»ID
- `minPrice` (å¯é€‰): æœ€ä½ä»·æ ¼
- `maxPrice` (å¯é€‰): æœ€é«˜ä»·æ ¼
- `sortBy` (å¯é€‰): æ’åºå­—æ®µï¼Œé»˜è®¤`updatedAt`
- `sortOrder` (å¯é€‰): æ’åºæ–¹å‘ï¼Œé»˜è®¤`desc`

**è¯´æ˜**:
- ä»…è¿”å› `isDeleted=true` çš„å•†å“
- é»˜è®¤æŒ‰ `updatedAt` é™åºæ’åºï¼ˆæœ€æ–°åˆ é™¤çš„åœ¨å‰ï¼‰
- æ”¯æŒæ‰€æœ‰å•†å“åˆ—è¡¨çš„ç­›é€‰å’Œæ’åºåŠŸèƒ½

**ç¤ºä¾‹è¯·æ±‚**:
```
GET /products/deleted?pageNum=1&pageSize=10&keyword=ä¼ æ„Ÿå™¨
Authorization: Bearer <admin_or_operator_token>
```

**å“åº”**:
```json
{
  "code": 200,
  "message": "Success",
  "data": {
    "list": [
      {
        "id": "clt123456789",
        "name": "æ™ºèƒ½æ¸©åº¦ä¼ æ„Ÿå™¨",
        "description": "é«˜ç²¾åº¦æ¸©åº¦ç›‘æµ‹ä¼ æ„Ÿå™¨",
        "price": 299.99,
        "originalPrice": 399.99,
        "stock": 100,
        "status": 1,
        "isDeleted": true,
        "deletedAt": "2026-02-04T10:00:00.000Z",
        "images": ["https://example.com/image1.jpg"],
        "category": {
          "id": "clt123456788",
          "name": "æ™ºèƒ½ä¼ æ„Ÿå™¨",
          "status": 1
        },
        "hasPrice": true,
        "tags": ["çƒ­é”€"],
        "updatedAt": "2026-02-04T10:00:00.000Z"
      }
    ],
    "total": 5,
    "pageNum": 1,
    "pageSize": 10,
    "totalPages": 1
  },
  "success": true
}
```

### ğŸ·ï¸ å±‚çº§åˆ†ç±»åç§°è¯´æ˜ (v1.1.2 æ–°å¢)

**åŠŸèƒ½è¯´æ˜**: æ‰€æœ‰å•†å“ç›¸å…³çš„APIè¿”å›çš„åˆ†ç±»ä¿¡æ¯(`category`)ç°åœ¨åŒ…å«å®Œæ•´çš„å±‚çº§ç»“æ„å’ŒçŠ¶æ€ä¿¡æ¯ã€‚

**å±‚çº§ç»“æ„è§„åˆ™**:
- **ä¸€çº§åˆ†ç±»**: ç›´æ¥æ˜¾ç¤ºåˆ†ç±»åç§°ï¼Œå¦‚ï¼š`"ç”µåŠ¨è®¾å¤‡"`ã€`"ç”µå­äº§å“"`
- **äºŒçº§åˆ†ç±»**: æ˜¾ç¤ºä¸º`çˆ¶çº§åˆ†ç±»/å­çº§åˆ†ç±»`æ ¼å¼ï¼Œå¦‚ï¼š`"ç”µå­äº§å“/æ‰‹æœºé…ä»¶"`ã€`"æ™ºèƒ½åŒ–è®¾å¤‡/è€—æé…ä»¶"`
- **å¤šçº§åˆ†ç±»**: æ”¯æŒæ— é™å±‚çº§ï¼Œæ˜¾ç¤ºä¸ºå®Œæ•´è·¯å¾„ï¼Œå¦‚ï¼š`"ä¸€çº§åˆ†ç±»/äºŒçº§åˆ†ç±»/ä¸‰çº§åˆ†ç±»"`

**åˆ†ç±»çŠ¶æ€ç®¡ç†è§„åˆ™**:
- **category.status**: åˆ†ç±»çŠ¶æ€å­—æ®µ(0=ç¦ç”¨, 1=å¯ç”¨)
- **è‡ªåŠ¨è¿‡æ»¤**: ç¦ç”¨åˆ†ç±»ä¸‹çš„å•†å“ä¸ä¼šå‡ºç°åœ¨å•†å“åˆ—è¡¨ã€æœç´¢ã€çƒ­é—¨å•†å“ç­‰APIä¸­
- **è¯¦æƒ…è®¿é—®**: å•†å“è¯¦æƒ…APIä»å¯è®¿é—®ç¦ç”¨åˆ†ç±»ä¸‹çš„å•†å“ï¼Œè¿”å›å®Œæ•´çš„categoryä¿¡æ¯åŒ…å«status=0
- **çº§è”æ§åˆ¶**: åˆ†ç±»ç¦ç”¨æ—¶ï¼Œæ‰€æœ‰å…³è”å•†å“è‡ªåŠ¨"ä¸‹æ¶"(ä¸åœ¨åˆ—è¡¨ä¸­æ˜¾ç¤º)ï¼Œå•†å“å¯ç”¨æ—¶å¯ç‹¬ç«‹æ§åˆ¶ä¸Šæ¶çŠ¶æ€

**é€‚ç”¨èŒƒå›´**: ä»¥ä¸‹æ‰€æœ‰å•†å“APIçš„è¿”å›æ•°æ®ä¸­åŒ…å«å®Œæ•´çš„`category`å¯¹è±¡ï¼š
- `GET /products` - è·å–å•†å“åˆ—è¡¨
- `GET /products/admin/all` - ç®¡ç†ç«¯ï¼ˆadmin/operatorï¼‰è·å–æ‰€æœ‰å•†å“
- `GET /products/:id` - è·å–å•†å“è¯¦æƒ…
- `GET /products/search` - æœç´¢å•†å“
- `GET /products/popular` - è·å–çƒ­é—¨å•†å“
- `GET /products/category/:categoryId` - æ ¹æ®åˆ†ç±»è·å–å•†å“

**ç‰¹æ®Šè¯´æ˜**:
- å•†åŸAPI (`GET /products`): é»˜è®¤ä»…è¿”å›å¯ç”¨åˆ†ç±»ä¸‹çš„å•†å“
- ç®¡ç†ç«¯API (`GET /products/admin/all`): è¿”å›æ‰€æœ‰åˆ†ç±»ä¸‹çš„å•†å“ï¼Œä¸å—åˆ†ç±»çŠ¶æ€é™åˆ¶

**å“åº”ç¤ºä¾‹å¯¹æ¯”**:

```json
// å¯ç”¨åˆ†ç±»ä¸‹çš„ä¸€çº§åˆ†ç±»å•†å“
{
  "id": "product-001",
  "name": "ç¬”è®°æœ¬ç”µè„‘",
  "category": {
    "id": "cat-001",
    "name": "ç”µåŠ¨è®¾å¤‡",  // ä¸€çº§åˆ†ç±»ï¼Œç›´æ¥æ˜¾ç¤º
    "status": 1  // å¯ç”¨çŠ¶æ€
  }
}

// å¯ç”¨åˆ†ç±»ä¸‹çš„äºŒçº§åˆ†ç±»å•†å“
{
  "id": "product-002",
  "name": "æ™ºèƒ½æ‰‹æœº",
  "category": {
    "id": "cat-002",
    "name": "ç”µå­äº§å“/æ‰‹æœºé…ä»¶",  // äºŒçº§åˆ†ç±»ï¼Œæ˜¾ç¤ºå±‚çº§ç»“æ„
    "status": 1  // å¯ç”¨çŠ¶æ€
  }
}

// ç¦ç”¨åˆ†ç±»ä¸‹çš„å•†å“ï¼ˆä»…åœ¨å•†å“è¯¦æƒ…ä¸­å¯è§ï¼‰
{
  "id": "product-003",
  "name": "ç¦ç”¨åˆ†ç±»å•†å“",
  "category": {
    "id": "cat-003",
    "name": "ç¦ç”¨æµ‹è¯•åˆ†ç±»",
    "status": 0  // ç¦ç”¨çŠ¶æ€ï¼Œè¯¥å•†å“ä¸ä¼šå‡ºç°åœ¨åˆ—è¡¨ã€æœç´¢ç­‰APIä¸­
  }
}
```

**å‰ç«¯é›†æˆå»ºè®®**:
- ç›´æ¥æ˜¾ç¤º `category.name` å³å¯ï¼Œæ— éœ€é¢å¤–å¤„ç†
- ä½¿ç”¨ `category.status` åˆ¤æ–­å•†å“æ˜¯å¦å¯ç”¨ï¼šstatus=1 å¯æ­£å¸¸æ˜¾ç¤ºï¼Œstatus=0 è¡¨ç¤ºåˆ†ç±»å·²ç¦ç”¨
- å¦‚éœ€æ˜¾ç¤ºé¢åŒ…å±‘å¯¼èˆªï¼Œå¯ä»¥ä½¿ç”¨ `/` åˆ†å‰²ç¬¦è§£æå±‚çº§å…³ç³»
- åˆ†ç±»IDä»ç„¶æŒ‡å‘å…·ä½“çš„å­åˆ†ç±»ï¼Œå¯ç”¨äºç­›é€‰å’ŒæŸ¥è¯¢
- **çŠ¶æ€æ£€æŸ¥**: åœ¨æ˜¾ç¤ºå•†å“å‰æ£€æŸ¥`category.status`ï¼Œç¦ç”¨åˆ†ç±»ä¸‹çš„å•†å“å»ºè®®æ˜¾ç¤º"æš‚æ— å¯ç”¨"æˆ–ç±»ä¼¼æç¤º
- **å•†å“è¯¦æƒ…**: å³ä½¿åˆ†ç±»ç¦ç”¨ï¼Œå•†å“è¯¦æƒ…APIä»å¯è®¿é—®ï¼Œå‰ç«¯å¯æ ¹æ®category.statuså†³å®šæ˜¯å¦æ˜¾ç¤ºè´­ä¹°æŒ‰é’®

---

## æ›´æ–°æ—¥å¿—

### v1.4.2 (2026-02-04)
- âœ… ä¿®æ­£æ‰¹é‡æ›´æ–°åº“å­˜APIå‚æ•°å­—æ®µåï¼š`list` â†’ `items`
- ğŸ†• æ–°å¢æ¢å¤å•ä¸ªå•†å“APIï¼š`POST /products/:id/restore`
- ğŸ†• æ–°å¢æ‰¹é‡æ¢å¤å•†å“APIï¼š`POST /products/batch/restore`
- ğŸ†• æ–°å¢è·å–å·²åˆ é™¤å•†å“åˆ—è¡¨APIï¼š`GET /products/deleted`

### v1.4.1 (2025-12-05)
- ğŸ·ï¸ æ–°å¢å•†å“æ ‡ç­¾ç³»ç»Ÿ (`tags` å­—æ®µ)
- æ”¯æŒJSONæ•°ç»„å’Œé€—å·åˆ†éš”å­—ç¬¦ä¸²æ ¼å¼

### v1.4.0 (2025-12-05)
- ğŸ’° æ–°å¢ `hasPrice` å­—æ®µï¼ŒåŒºåˆ†è´­ä¹°å•†å“å’Œå’¨è¯¢å•†å“
- æ”¯æŒä»·æ ¼å­—æ®µä¸º `null` æˆ– `0` çš„å’¨è¯¢å•†å“

### v1.1.2 (2025-12-03)
- ğŸ·ï¸ æ–°å¢å±‚çº§åˆ†ç±»åç§°æ˜¾ç¤º
- ğŸ“Š æ–°å¢åˆ†ç±»çŠ¶æ€ç®¡ç†
- ğŸ”„ åˆ†ç±»çŠ¶æ€è‡ªåŠ¨è¿‡æ»¤åŠŸèƒ½

### v1.1.0 (2025-12-02)
- ğŸ”„ æ–°å¢å•†å“æ’åºåŠŸèƒ½
- ğŸ“Š æ”¯æŒæŒ‰ä»·æ ¼ã€åç§°ã€åº“å­˜ã€åˆ›å»ºæ—¶é—´æ’åº
- â¬†ï¸â¬‡ï¸ æ”¯æŒå‡åºå’Œé™åº

---
